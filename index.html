<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no, viewport-fit=cover">
  <title>大老二記分所</title>
  
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://unpkg.com/react@18/umd/react.production.min.js"></script>
  <script src="https://unpkg.com/react-dom@18/umd/react-dom.production.min.js"></script>
  <script src="https://unpkg.com/@babel/standalone/babel.min.js"></script>

  <style>
    :root {
      --safe-top: env(safe-area-inset-top, 24px);
      --safe-bottom: env(safe-area-inset-bottom, 24px);
    }

    body {
      /* 深紅紫漸層，沉穩不刺眼 */
      background: linear-gradient(135deg, #2C0E0E 0%, #4A0F1C 100%);
      color: #F8FAFC;
      margin: 0;
      overflow: hidden;
      font-family: -apple-system, BlinkMacSystemFont, "SF Pro Display", "PingFang TC", sans-serif;
      -webkit-tap-highlight-color: transparent;
      user-select: none;
    }

    /* iOS 26 毛玻璃面板 */
    .hyper-glass {
      background: rgba(255, 255, 255, 0.08);
      backdrop-filter: blur(24px);
      -webkit-backdrop-filter: blur(24px);
      border: 1px solid rgba(255, 255, 255, 0.15);
      box-shadow: 0 12px 40px rgba(0, 0, 0, 0.3);
    }

    .glass-nav {
      background: rgba(30, 10, 12, 0.75);
      backdrop-filter: blur(32px) saturate(180%);
      -webkit-backdrop-filter: blur(32px) saturate(180%);
      border-top: 1px solid rgba(255, 255, 255, 0.1);
    }

    /* 燈籠緩慢呼吸動畫 (4.5秒) */
    @keyframes slow-breathe {
      0%, 100% { opacity: 0.12; }
      50% { opacity: 0.25; }
    }
    .animate-lantern {
      animation: slow-breathe 4.5s ease-in-out infinite;
    }
    .animate-lantern-delayed {
      animation: slow-breathe 5s ease-in-out infinite 2s;
    }

    /* 皇冠微晃動 (儀式感) */
    @keyframes subtle-wobble {
      0%, 100% { transform: rotate(0deg); }
      25% { transform: rotate(-3deg); }
      75% { transform: rotate(3deg); }
    }
    .animate-crown {
      animation: subtle-wobble 3s ease-in-out infinite;
    }

    /* 分數變動動畫 */
    @keyframes score-up {
      0%, 100% { transform: scale(1); text-shadow: none; }
      40% { transform: scale(1.08); text-shadow: 0 0 16px rgba(132, 204, 22, 0.6); }
    }
    @keyframes score-down {
      0%, 100% { transform: translateY(0); }
      40% { transform: translateY(4px); text-shadow: 0 0 12px rgba(252, 165, 165, 0.4); }
    }
    .score-animate-up { animation: score-up 0.6s cubic-bezier(0.34, 1.56, 0.64, 1); }
    .score-animate-down { animation: score-down 0.6s cubic-bezier(0.34, 1.56, 0.64, 1); }

    /* 等寬數字，防止版面跳動 */
    .tabular-nums {
      font-variant-numeric: tabular-nums;
    }

    /* 大型按鈕按壓回饋 */
    .btn-press:active {
      transform: scale(0.96);
      filter: brightness(0.9);
      transition: all 0.1s ease-out;
    }

    .custom-scroll::-webkit-scrollbar { display: none; }
    .custom-scroll { scrollbar-width: none; }
  </style>
</head>
<body>
  <div id="root"></div>

  <script type="text/babel">
    const { useState, useEffect, useMemo, useRef } = React;

    // SVG 圖標庫 (加粗線條，長輩更易辨識)
    const Icon = ({ name, className = "w-7 h-7" }) => {
      const svgs = {
        trophy: <svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"/><path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"/><path d="M4 22h16"/><path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"/><path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"/><path d="M18 2H6v7a6 6 0 0 0 12 0V2Z"/></svg>,
        history: <svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><polyline points="12 6 12 12 16 14"/></svg>,
        play: <svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><polygon points="5 3 19 12 5 21 5 3"/></svg>,
        minus: <svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round"><line x1="5" y1="12" x2="19" y2="12"/></svg>,
        plus: <svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2.5" strokeLinecap="round" strokeLinejoin="round"><line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/></svg>,
        info: <svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="12" cy="12" r="10"/><line x1="12" y1="16" x2="12" y2="12"/><line x1="12" y1="8" x2="12.01" y2="8"/></svg>,
        share: <svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><circle cx="18" cy="5" r="3"/><circle cx="6" cy="12" r="3"/><circle cx="18" cy="19" r="3"/><line x1="8.59" y1="13.51" x2="15.42" y2="17.49"/><line x1="15.41" y1="6.51" x2="8.59" y2="10.49"/></svg>,
        eye: <svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M2 12s3-7 10-7 10 7 10 7-3 7-10 7-10-7-10-7Z"/><circle cx="12" cy="12" r="3"/></svg>,
        eyeOff: <svg className={className} viewBox="0 0 24 24" fill="none" stroke="currentColor" strokeWidth="2" strokeLinecap="round" strokeLinejoin="round"><path d="M9.88 9.88a3 3 0 1 0 4.24 4.24"/><path d="M10.73 5.08A10.43 10.43 0 0 1 12 5c7 0 10 7 10 7a13.16 13.16 0 0 1-1.67 2.68"/><path d="M6.61 6.61A13.526 13.526 0 0 0 2 12s3 7 10 7a9.74 9.74 0 0 0 5.39-1.61"/><line x1="2" y1="2" x2="22" y2="22"/></svg>,
        crown: <svg className={className} viewBox="0 0 24 24" fill="#FBBF24" stroke="#D97706" strokeWidth="1" strokeLinecap="round" strokeLinejoin="round"><path d="M2 4l3 12h14l3-12-6 7-4-7-4 7-6-7zm3 16h14"/></svg>
      };
      return svgs[name] || null;
    };

    // 線稿版低調燈籠背景
    const WireframeLanterns = () => (
      <div className="absolute inset-0 z-0 pointer-events-none overflow-hidden">
        {/* 極淡金色微粒 */}
        <div className="absolute inset-0 bg-[url('data:image/svg+xml;base64,PHN2ZyB4bWxucz0iaHR0cDovL3d3dy53My5vcmcvMjAwMC9zdmciIHdpZHRoPSI4IiBoZWlnaHQ9IjgiPgo8Y2lyY2xlIGN4PSI0IiBjeT0iNCIgcj0iMC41IiBmaWxsPSJyZ2JhKDI1MSwgMTkxLCAzNiwgMC4xNSkiLz4KPC9zdmc+')] opacity-50" style={{ backgroundSize: '40px 40px' }}></div>
        
        {/* 左側大線稿燈籠 */}
        <div className="absolute -left-12 -top-10 w-64 h-80 animate-lantern text-[#FDE047]">
          <svg viewBox="0 0 100 150" fill="none" stroke="currentColor" strokeWidth="0.5">
            <line x1="50" y1="0" x2="50" y2="20" strokeWidth="1" />
            <rect x="35" y="20" width="30" height="5" />
            <path d="M20 25 Q 5 65 20 105 L 80 105 Q 95 65 80 25 Z" />
            <path d="M35 25 Q 20 65 35 105" />
            <path d="M50 25 L 50 105" />
            <path d="M65 25 Q 80 65 65 105" />
            <rect x="35" y="105" width="30" height="5" />
            <line x1="40" y1="110" x2="35" y2="140" strokeWidth="0.5" />
            <line x1="50" y1="110" x2="50" y2="145" strokeWidth="0.5" />
            <line x1="60" y1="110" x2="65" y2="140" strokeWidth="0.5" />
          </svg>
        </div>

        {/* 右側小線稿燈籠 */}
        <div className="absolute -right-8 top-10 w-48 h-64 animate-lantern-delayed text-[#FDE047]">
          <svg viewBox="0 0 100 150" fill="none" stroke="currentColor" strokeWidth="0.5">
            <line x1="50" y1="0" x2="50" y2="20" strokeWidth="1" />
            <rect x="35" y="20" width="30" height="5" />
            <path d="M20 25 Q 5 65 20 105 L 80 105 Q 95 65 80 25 Z" />
            <path d="M50 25 L 50 105" />
            <rect x="35" y="105" width="30" height="5" />
            <line x1="45" y1="110" x2="40" y2="140" strokeWidth="0.5" />
            <line x1="55" y1="110" x2="60" y2="140" strokeWidth="0.5" />
          </svg>
        </div>
      </div>
    );

    // 負責處理分數跳動動畫的包裹器，不動到外層邏輯
    const AnimatedScore = ({ score, reduceMotion }) => {
      const prevScore = useRef(score);
      const [animClass, setAnimClass] = useState('');

      useEffect(() => {
        if (reduceMotion) return;
        if (score > prevScore.current) {
          setAnimClass('score-animate-up');
          const timer = setTimeout(() => setAnimClass(''), 600);
          return () => clearTimeout(timer);
        } else if (score < prevScore.current) {
          setAnimClass('score-animate-down');
          const timer = setTimeout(() => setAnimClass(''), 600);
          return () => clearTimeout(timer);
        }
        prevScore.current = score;
      }, [score, reduceMotion]);

      const isPositive = score > 0;
      const isNegative = score < 0;
      const sign = isPositive ? '+' : '';

      return (
        <span className={`inline-block tabular-nums transition-colors duration-300 ${animClass} ${isPositive ? 'text-[#84CC16]' : isNegative ? 'text-[#FCA5A5]' : 'text-white/40'}`}>
          {sign}{score}
        </span>
      );
    };

    const App = () => {
      const INITIAL_PLAYERS = [
        { id: 'p1', name: '爸爸', score: 0 },
        { id: 'p2', name: '媽媽', score: 0 },
        { id: 'p3', name: '哥哥', score: 0 },
        { id: 'p4', name: '妹妹', score: 0 },
      ];

      const [players, setPlayers] = useState(INITIAL_PLAYERS);
      const [history, setHistory] = useState([]);
      const [activeTab, setActiveTab] = useState('scores'); // 預設停在排行榜
      const [currentCards, setCurrentCards] = useState({ p1: 0, p2: 0, p3: 0, p4: 0 });
      const [twoCounts, setTwoCounts] = useState({ p1: 0, p2: 0, p3: 0, p4: 0 });
      const [winnerTwoCount, setWinnerTwoCount] = useState(0);
      const [toast, setToast] = useState(null);
      const [showRules, setShowRules] = useState(false);
      const [reduceMotion, setReduceMotion] = useState(false);

      const showToast = (msg, type = 'normal') => {
        setToast({ msg, type });
        setTimeout(() => setToast(null), 3000);
      };

      useEffect(() => {
        const savedP = localStorage.getItem('big2_players_v3');
        const savedH = localStorage.getItem('big2_history_v3');
        if (savedP) setPlayers(JSON.parse(savedP));
        if (savedH) setHistory(JSON.parse(savedH));
      }, []);

      useEffect(() => {
        localStorage.setItem('big2_players_v3', JSON.stringify(players));
        localStorage.setItem('big2_history_v3', JSON.stringify(history));
      }, [players, history]);

      const changeCard = (id, delta) => {
        setCurrentCards(prev => {
          const newVal = Math.max(0, Math.min(13, prev[id] + delta));
          if (newVal === 0) setTwoCounts(p => ({ ...p, [id]: 0 }));
          return { ...prev, [id]: newVal };
        });
      };

      const toggleTwo = (id) => {
        if (currentCards[id] === 0) return;
        setTwoCounts(prev => ({ ...prev, [id]: (prev[id] + 1) % 5 }));
      };

      const calculate = () => {
        const pIds = ['p1', 'p2', 'p3', 'p4'];
        const winners = pIds.filter(id => currentCards[id] === 0);
        
        if (winners.length !== 1) {
          showToast("請確認：剛好只有一人剩 0 張才能結算。", "error");
          return;
        }

        const winnerId = winners[0];
        let totalPot = 0;
        const roundScores = {};

        pIds.forEach(id => {
          if (id === winnerId) {
            roundScores[id] = 0;
          } else {
            let p = currentCards[id];
            if (p >= 8) p *= 2; 
            if (twoCounts[id] > 0) p *= Math.pow(2, twoCounts[id]); 
            if (winnerTwoCount > 0) p *= Math.pow(2, winnerTwoCount); 
            
            roundScores[id] = -p;
            totalPot += p;
          }
        });

        roundScores[winnerId] = totalPot;

        setPlayers(prev => prev.map(p => ({ ...p, score: p.score + roundScores[p.id] })));
        setHistory([{
          id: Date.now(),
          time: new Date().toLocaleTimeString('zh-TW', { hour: '2-digit', minute: '2-digit' }),
          scores: roundScores,
          isExtreme: winnerTwoCount > 0
        }, ...history]);

        setCurrentCards({ p1: 0, p2: 0, p3: 0, p4: 0 });
        setTwoCounts({ p1: 0, p2: 0, p3: 0, p4: 0 });
        setWinnerTwoCount(0);
        setActiveTab('scores'); // 結算後自動跳轉排行榜
        showToast("結算完成", "success");
      };

      const undo = () => {
        if (!history.length || !window.confirm("確定要收回上一局嗎？")) return;
        const [last, ...rest] = history;
        setPlayers(prev => prev.map(p => ({ ...p, score: p.score - last.scores[p.id] })));
        setHistory(rest);
      };

      return (
        <div className="w-full h-[100dvh] relative flex flex-col mx-auto max-w-md shadow-2xl overflow-hidden selection:bg-red-900/50">
          <WireframeLanterns />

          {/* 頂部通知浮窗 */}
          <div className={`absolute top-[var(--safe-top)] left-4 right-4 z-50 transition-all duration-400 transform ${toast ? 'translate-y-2 opacity-100' : '-translate-y-10 opacity-0 pointer-events-none'}`}>
            <div className={`px-5 py-4 rounded-[20px] text-[18px] font-bold shadow-2xl backdrop-blur-xl border ${toast && toast.type === 'error' ? 'bg-[#4A0F1C]/90 border-red-400/50 text-white' : 'bg-[#1e2e1e]/90 border-[#84CC16]/50 text-white'} flex items-center justify-center`}>
              {toast && toast.msg}
            </div>
          </div>

          {/* 標題列：加大字體、直覺操作 */}
          <header className="pt-[calc(var(--safe-top)+12px)] pb-4 px-6 relative z-10 flex justify-between items-center">
            <h1 className="text-[32px] font-bold tracking-[0.15em] text-white/95">
              大老二記分所
            </h1>
            <div className="flex gap-2">
              <button onClick={() => setReduceMotion(!reduceMotion)} className="w-12 h-12 rounded-full hyper-glass flex items-center justify-center btn-press text-white/80">
                <Icon name={reduceMotion ? "eyeOff" : "eye"} className="w-6 h-6" />
              </button>
              <button onClick={() => setShowRules(true)} className="w-12 h-12 rounded-full hyper-glass flex items-center justify-center btn-press text-white/80">
                <Icon name="info" className="w-6 h-6" />
              </button>
            </div>
          </header>

          <main className="flex-1 relative z-10 flex flex-col px-5 pb-[calc(90px+var(--safe-bottom))]">
            
            {/* === 排行榜 (長輩友善重構版) === */}
            {activeTab === 'scores' && (
              <div className="flex-1 flex flex-col animate-in fade-in duration-300">
                {/* 中央大型卡片 */}
                <div className="hyper-glass rounded-[32px] p-4 sm:p-6 flex flex-col gap-3 flex-1 mb-6 mt-2">
                  {[...players].sort((a, b) => b.score - a.score).map((p, idx) => {
                    const isFirst = idx === 0 && p.score > 0;
                    return (
                      <div key={p.id} className={`relative flex items-center justify-between px-5 min-h-[80px] rounded-[24px] border ${isFirst ? 'bg-gradient-to-r from-amber-600/20 to-transparent border-amber-500/40' : 'bg-white/5 border-white/10'}`}>
                        <div className="flex items-center gap-5">
                          {isFirst ? (
                            <div className="w-8 flex justify-center">
                              <Icon name="crown" className={`w-8 h-8 ${!reduceMotion && 'animate-crown'}`} />
                            </div>
                          ) : (
                            <span className="w-8 text-center text-[22px] font-bold text-white/30">
                              {idx + 1}
                            </span>
                          )}
                          <span className="text-[24px] font-semibold tracking-widest text-white/95">{p.name}</span>
                        </div>
                        
                        <div className="text-[34px] font-bold text-right min-w-[80px]">
                          <AnimatedScore score={p.score} reduceMotion={reduceMotion} />
                        </div>
                      </div>
                    );
                  })}
                </div>

                {/* 巨型清算按鈕 */}
                <button 
                  onClick={() => window.confirm("確定要把所有人的分數歸零，重新開始嗎？") && setPlayers(INITIAL_PLAYERS) || setHistory([])} 
                  className="w-full min-h-[64px] rounded-[24px] bg-[#3B1515] border border-[#FCA5A5]/30 text-[#FCA5A5] text-[20px] font-bold tracking-widest btn-press shadow-lg flex items-center justify-center"
                >
                  重新洗牌清算
                </button>
              </div>
            )}

            {/* === 上桌記分 (保持原有功能，微調字體大小) === */}
            {activeTab === 'play' && (
              <div className="flex-1 flex flex-col animate-in fade-in duration-300 h-full overflow-y-auto custom-scroll pb-4">
                <div className="flex flex-col gap-4">
                  {INITIAL_PLAYERS.map(base => {
                    const id = base.id;
                    const p = players.find(x => x.id === id);
                    const isWinner = currentCards[id] === 0;
                    
                    return (
                      <div key={id} className={`hyper-glass rounded-[28px] p-4 flex items-center justify-between ${twoCounts[id] > 0 ? 'border-amber-500/50 bg-amber-950/20' : ''}`}>
                        <div className="flex flex-col gap-3 pl-2">
                          <span className="text-[24px] font-semibold tracking-widest">{p.name}</span>
                          <button 
                            onClick={() => toggleTwo(id)}
                            disabled={isWinner}
                            className={`px-4 py-2 rounded-xl text-[16px] font-bold transition-colors border btn-press ${isWinner ? 'opacity-30 border-transparent bg-black/20' : twoCounts[id] > 0 ? 'bg-amber-500/20 text-amber-300 border-amber-400/50' : 'bg-white/10 text-white/60 border-white/10'}`}
                          >
                            {isWinner ? '脫手' : twoCounts[id] > 0 ? `扣老二 × ${twoCounts[id]}` : '沒老二'}
                          </button>
                        </div>

                        <div className="flex items-center gap-4 bg-black/30 p-2 rounded-[24px] border border-white/10">
                          <button onClick={() => changeCard(id, -1)} className="w-14 h-14 rounded-[18px] bg-white/10 btn-press flex items-center justify-center text-white">
                            <Icon name="minus" />
                          </button>
                          <div className="w-10 text-center text-[34px] font-bold tabular-nums">
                            {currentCards[id]}
                          </div>
                          <button onClick={() => changeCard(id, 1)} className="w-14 h-14 rounded-[18px] bg-white/10 btn-press flex items-center justify-center text-white">
                            <Icon name="plus" />
                          </button>
                        </div>
                      </div>
                    );
                  })}
                </div>

                <div className="mt-6 space-y-4">
                  <button 
                    onClick={() => setWinnerTwoCount(v => (v + 1) % 5)}
                    className={`w-full min-h-[64px] rounded-[24px] text-[18px] font-bold border btn-press ${winnerTwoCount > 0 ? 'bg-[#4A0F1C] text-red-200 border-red-400/50' : 'hyper-glass text-white/60'}`}
                  >
                    {winnerTwoCount > 0 ? `大招：老二結尾 × ${winnerTwoCount} (全場翻倍)` : '一般脫手 (無加倍)'}
                  </button>
                  
                  <button 
                    onClick={calculate}
                    className="w-full min-h-[72px] rounded-[24px] bg-[#84CC16] text-[#142004] text-[24px] font-bold tracking-[0.2em] shadow-[0_4px_20px_rgba(132,204,22,0.3)] btn-press"
                  >
                    結算此局
                  </button>
                </div>
              </div>
            )}

            {/* === 歷史明細 === */}
            {activeTab === 'history' && (
              <div className="flex-1 overflow-y-auto custom-scroll animate-in fade-in duration-300 pb-4">
                <div className="flex justify-between items-center mb-6 px-2">
                  <span className="text-[20px] font-bold text-white/80">局數明細</span>
                  {history.length > 0 && (
                    <button onClick={undo} className="text-[18px] text-[#FCA5A5] bg-[#FCA5A5]/10 px-4 py-2 rounded-xl btn-press">
                      撤回上一局
                    </button>
                  )}
                </div>
                
                <div className="space-y-4">
                  {!history.length ? (
                    <div className="py-20 text-center text-[20px] text-white/40 font-bold">目前無任何紀錄</div>
                  ) : (
                    history.map((rec) => (
                      <div key={rec.id} className="hyper-glass rounded-[24px] p-5">
                        <div className="flex justify-between items-center mb-4 pb-4 border-b border-white/10">
                          <span className="text-[18px] text-white/60 font-medium">{rec.time}</span>
                          {rec.isExtreme && <span className="text-[16px] text-red-300 bg-red-950/50 px-3 py-1 rounded-lg">老二翻倍</span>}
                        </div>
                        <div className="grid grid-cols-4 gap-2 text-center">
                          {INITIAL_PLAYERS.map(p => {
                            const s = rec.scores[p.id];
                            return (
                              <div key={p.id}>
                                <div className="text-[16px] text-white/50 mb-2">{p.name}</div>
                                <div className={`text-[22px] font-bold tabular-nums ${s > 0 ? 'text-[#84CC16]' : s < 0 ? 'text-[#FCA5A5]' : 'text-white/30'}`}>
                                  {s > 0 ? `+${s}` : s}
                                </div>
                              </div>
                            );
                          })}
                        </div>
                      </div>
                    ))
                  )}
                </div>
              </div>
            )}
          </main>

          {/* 底部導航列 (iOS 26 玻璃擬態，清楚文字標籤) */}
          <nav className="absolute bottom-0 w-full glass-nav pb-[var(--safe-bottom)] pt-3 px-6 z-20">
            <div className="flex justify-between items-center max-w-[320px] mx-auto">
              {[
                { id: 'scores', label: '排行榜', icon: 'trophy' },
                { id: 'play', label: '記分', icon: 'play' },
                { id: 'history', label: '明細', icon: 'history' }
              ].map(tab => {
                const isActive = activeTab === tab.id;
                return (
                  <button 
                    key={tab.id}
                    onClick={() => setActiveTab(tab.id)} 
                    className={`flex flex-col items-center gap-2 w-[80px] pb-2 transition-all duration-300 btn-press ${isActive ? 'text-[#FDE047] border-b-4 border-[#FDE047] rounded-sm' : 'text-white/50 border-b-4 border-transparent'}`}
                  >
                    <Icon name={tab.icon} className="w-8 h-8" />
                    <span className="text-[16px] font-bold tracking-widest">{tab.label}</span>
                  </button>
                );
              })}
            </div>
          </nav>

          {/* 規則解說 Modal */}
          {showRules && (
            <div className="absolute inset-0 z-[100] flex items-center justify-center p-6 animate-in fade-in duration-200">
              <div className="absolute inset-0 bg-black/60 backdrop-blur-md" onClick={() => setShowRules(false)}></div>
              <div className="relative w-full hyper-glass rounded-[32px] p-8 shadow-2xl">
                <h3 className="text-[28px] font-bold text-white mb-6 text-center tracking-widest">記分說明</h3>
                <div className="space-y-6 text-[20px] leading-relaxed text-white/80">
                  <p><strong className="text-white block mb-2">基本扣分</strong>剩餘 1-7 張照算。<br/><span className="text-[#FDE047]">8 張以上(含) 分數兩倍。</span></p>
                  <p><strong className="text-white block mb-2">輸家留老二</strong>每留 1 張，總分再翻 1 倍。<br/>(兩張變 4 倍)</p>
                  <div className="bg-[#4A0F1C]/40 p-4 rounded-2xl border border-red-500/30">
                    <strong className="text-red-300 block mb-2">贏家出老二</strong>贏家最後一張打老二脫手，<br/>全場輸家分數 <span className="text-red-300 font-bold">強制翻倍</span>。
                  </div>
                </div>
                <button onClick={() => setShowRules(false)} className="w-full mt-8 bg-white/20 py-5 rounded-[20px] text-white text-[22px] font-bold tracking-widest btn-press border border-white/20">
                  我知道了
                </button>
              </div>
            </div>
          )}
        </div>
      );
    };

    const root = ReactDOM.createRoot(document.getElementById('root'));
    root.render(<App />);
  </script>
</body>
</html>
